# Balloon Segmentation using Mask R-CNN

This project implements **instance segmentation** using a pre-trained **Mask R-CNN** model to detect and segment balloons in images. The task involves adopting and modifying a pre-trained model to perform instance segmentation and color in detected balloons.

## Table of Contents
- [Project Overview](#project-overview)
- [Dataset](#dataset)
- [Methodology](#methodology)
  - [Network Architecture](#network-architecture)
  - [Model Training and Inference](#model-training-and-inference)
- [Results](#results)
- [Installation](#installation)
- [Usage](#usage)
- [Contributing](#contributing)
- [License](#license)

## Project Overview

In this project, we use **Mask R-CNN** to perform **instance segmentation** on the **balloons dataset**. The pre-trained Mask R-CNN model is adapted for this task, which allows us to detect individual balloons in an image and automatically color them using segmentation masks.

## Dataset

The dataset used for this project is the **Balloons dataset**, which can be downloaded from:
- [Balloons Dataset](https://github.com/matterport/Mask_RCNN/releases)

The dataset contains images of balloons that need to be segmented and highlighted using instance segmentation techniques.

## Methodology

### Network Architecture

The **Mask R-CNN** architecture is used for this task, which is a powerful model designed for instance segmentation. The architecture includes the following components:
- **Backbone**: A feature extractor, typically a **ResNet** variant, that extracts feature maps from the input image.
- **Region Proposal Network (RPN)**: Proposes regions of interest that may contain objects.
- **ROI Align**: Extracts fixed-size feature maps from the proposed regions.
- **Mask Head**: Generates pixel-level masks for each detected object.
  
The pre-trained model uses weights trained on the **COCO** dataset, which were fine-tuned for balloon detection using the provided dataset.

### Model Training and Inference

1. **Pre-trained Model**: We adopted a pre-trained **Mask R-CNN** model. The weights used are from `mask_rcnn_balloon.h5`, a model specifically fine-tuned for balloon detection.
  
2. **Input Processing**: 
   - Input images are loaded and converted from BGR to RGB format.
   - Preprocessing includes resizing the images to a standard size and normalizing pixel values.

3. **Prediction**:
   - The pre-trained Mask R-CNN model performs a forward pass on the input images.
   - The model outputs **bounding boxes**, **class IDs**, **segmentation masks**, and **confidence scores** for each detected object.
  
4. **Visualization**: The results are visualized by overlaying the bounding boxes and masks on the original images. Each balloon is automatically colored based on the segmentation mask.

## Results

The model successfully segments balloons in the input images, as demonstrated by the segmentation masks and bounding boxes generated by Mask R-CNN. The model achieves reasonable accuracy in detecting and segmenting balloons, as shown in the following example:

**Figure 1**: Result Balloon Segmentation

## Installation

1. Clone the repository:
 

2. Install the required dependencies:
   

3. Download the **Balloons dataset** and place it in the `data/` directory:
    ```bash
    data/
        |-- balloon/
    ```

4. Download the pre-trained Mask R-CNN weights:
    ```bash
    wget https://github.com/matterport/Mask_RCNN/releases/download/v2.1/mask_rcnn_balloon.h5
    ```

## Usage

1. **Run Inference on the Balloon Dataset**:
    

2. **Visualize the Results**:
    The segmented balloons will be displayed with bounding boxes and masks overlaid on the input image.

